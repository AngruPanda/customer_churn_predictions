# Проект по предсказанию оттока клиентов 

## Задача
Нужна модель, которая будет предсказывать, разорвёт ли абонент договор, чтобы предлагать клиенту акции и специальные условия. Для этого заказчик передал БД с четыремя таблицами различной информации.

## Процесс
Таблицы были загружены, исследованы и предобработанны. На основании исследовательского анализа составлены портреты обычного пользователя. 
Таблицы объеденины в сводную, общую таблицу. В свободной таблицы изучено влияние основных признаков на целевую переменную и уже на основании этого анализа
составлены портреты ушедших и оставшихся клиентов:

* Оставшиеся клиенты - клиенты, которые активно пользуются различными сервисами, тратят около 70 в месяц, а их затраты за год не превышают 1200, с подпиской month-to-month
* Ушедшие клиенты - клиенты, не охотно пользующиеся сервисами и с годичными подписками

Проведен корреляционный анализ и отсечены наиболее не важные признаки.
Обучены и подобраны гиперпараметры для трех моделей, результаты получились такими:

* RandomForestClassifier - ROC-AUC = 0.825
* CatBoostClassifier - ROC-AUC = 0.880
* Нейронная сеть - ROC-AUC = 0.815

Лучшей моделью оказалась - модель бустинга CatBoostClassifier. Далее подтвердили метрику на тестовой выборке и построили confusion matrix для раных порогов.
Оптимальным является случай при пороге 0.5, тк ошибка первого рода не превышает верно предсказанный 1 класс и ошибка второго рода не сильно возрастает по сравнению
с предыдущими порогами. Добится варианта при котором ошибка второго рода будет нулевой не предоставляется возможным.

Проведен анализ лучшей модели с помощью метода SHAP - в топ 5 влиятельных признаков вошли все числовые признаки: DaysContract, MonthlyCharges, TotalCharges,
а также категориальные признаки, отвечающие за присутствие партнера Partner и за двух-годичную подписку Two year.

## Вывод

Получена модель CatBoostClassifier с показателем метрики ROC-AUC равным 0.9. Также было в процессе изучена новая библиотека и инструмент
keras tuner для подбора гиперпарметров нейронных сетей.

Youtube видео - https://www.youtube.com/watch?v=M08yHFPKTNI

Jupyter тетрадка в colab - https://colab.research.google.com/drive/1m_8puwuGg9C7LWChv4YvZEmAlocGC7nG#scrollTo=qrfd6FzSLrE2
